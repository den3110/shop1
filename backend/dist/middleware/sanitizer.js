"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.sanitize = void 0;
var sanitize = exports.sanitize = function sanitize() {
  var ignore = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
  return function (req, res, next) {
    var data = [];
    if (req.body) {
      data = Object.keys(req.body);
      for (var i = 0; i < data.length; i++) {
        if (ignore.indexOf(data[i]) == -1 && typeof req.body[data[i]] == 'string') req.body[data[i]] = req.sanitize(req.body[data[i]]).trim();
      }
    }
    if (req.params) {
      data = Object.keys(req.params);
      for (var i = 0; i < data.length; i++) {
        if (ignore.indexOf(data[i]) == -1 && typeof req.params[data[i]] == 'string') req.params[data[i]] = req.sanitize(req.params[data[i]]).trim();
      }
    }
    if (req.query) {
      data = Object.keys(req.query);
      for (var i = 0; i < data.length; i++) {
        if (ignore.indexOf(data[i]) == -1 && typeof req.query[data[i]] == 'string') req.query[data[i]] = req.sanitize(req.query[data[i]]).trim();
      }
    }
    next();
  };
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzYW5pdGl6ZSIsImV4cG9ydHMiLCJpZ25vcmUiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJyZXEiLCJyZXMiLCJuZXh0IiwiZGF0YSIsImJvZHkiLCJPYmplY3QiLCJrZXlzIiwiaSIsImluZGV4T2YiLCJ0cmltIiwicGFyYW1zIiwicXVlcnkiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvbWlkZGxld2FyZS9zYW5pdGl6ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHNhbml0aXplID0gZnVuY3Rpb24oaWdub3JlPVtdKXtcclxuICAgIHJldHVybiAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICAgICAgICB2YXIgZGF0YSA9IFtdO1xyXG4gICAgICAgIGlmKHJlcS5ib2R5KXtcclxuICAgICAgICAgICAgZGF0YSA9IE9iamVjdC5rZXlzKHJlcS5ib2R5KTtcclxuICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxkYXRhLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICAgICAgaWYoaWdub3JlLmluZGV4T2YoZGF0YVtpXSkgPT0gLTEgJiYgdHlwZW9mIHJlcS5ib2R5W2RhdGFbaV1dID09ICdzdHJpbmcnKVxyXG4gICAgICAgICAgICAgICAgICAgIHJlcS5ib2R5W2RhdGFbaV1dID0gcmVxLnNhbml0aXplKHJlcS5ib2R5W2RhdGFbaV1dKS50cmltKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYocmVxLnBhcmFtcyl7XHJcbiAgICAgICAgICAgIGRhdGEgPSBPYmplY3Qua2V5cyhyZXEucGFyYW1zKTtcclxuICAgICAgICAgICAgZm9yKHZhciBpPTA7aTxkYXRhLmxlbmd0aDtpKyspe1xyXG4gICAgICAgICAgICAgICAgaWYoaWdub3JlLmluZGV4T2YoZGF0YVtpXSkgPT0gLTEgJiYgdHlwZW9mIHJlcS5wYXJhbXNbZGF0YVtpXV0gPT0gJ3N0cmluZycpXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxLnBhcmFtc1tkYXRhW2ldXSA9IHJlcS5zYW5pdGl6ZShyZXEucGFyYW1zW2RhdGFbaV1dKS50cmltKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYocmVxLnF1ZXJ5KXtcclxuICAgICAgICAgICAgZGF0YSA9IE9iamVjdC5rZXlzKHJlcS5xdWVyeSk7XHJcbiAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8ZGF0YS5sZW5ndGg7aSsrKXtcclxuICAgICAgICAgICAgICAgIGlmKGlnbm9yZS5pbmRleE9mKGRhdGFbaV0pID09IC0xICYmIHR5cGVvZiByZXEucXVlcnlbZGF0YVtpXV0gPT0gJ3N0cmluZycpXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxLnF1ZXJ5W2RhdGFbaV1dID0gcmVxLnNhbml0aXplKHJlcS5xdWVyeVtkYXRhW2ldXSkudHJpbSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBcclxuICAgICAgICBuZXh0KCk7XHJcbiAgICB9XHJcbn07ICJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQU8sSUFBTUEsUUFBUSxHQUFBQyxPQUFBLENBQUFELFFBQUEsR0FBRyxTQUFYQSxRQUFRQSxDQUFBLEVBQXNCO0VBQUEsSUFBVkUsTUFBTSxHQUFBQyxTQUFBLENBQUFDLE1BQUEsUUFBQUQsU0FBQSxRQUFBRSxTQUFBLEdBQUFGLFNBQUEsTUFBQyxFQUFFO0VBQ3RDLE9BQU8sVUFBQ0csR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksRUFBSztJQUN2QixJQUFJQyxJQUFJLEdBQUcsRUFBRTtJQUNiLElBQUdILEdBQUcsQ0FBQ0ksSUFBSSxFQUFDO01BQ1JELElBQUksR0FBR0UsTUFBTSxDQUFDQyxJQUFJLENBQUNOLEdBQUcsQ0FBQ0ksSUFBSSxDQUFDO01BQzVCLEtBQUksSUFBSUcsQ0FBQyxHQUFDLENBQUMsRUFBQ0EsQ0FBQyxHQUFDSixJQUFJLENBQUNMLE1BQU0sRUFBQ1MsQ0FBQyxFQUFFLEVBQUM7UUFDMUIsSUFBR1gsTUFBTSxDQUFDWSxPQUFPLENBQUNMLElBQUksQ0FBQ0ksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxPQUFPUCxHQUFHLENBQUNJLElBQUksQ0FBQ0QsSUFBSSxDQUFDSSxDQUFDLENBQUMsQ0FBQyxJQUFJLFFBQVEsRUFDcEVQLEdBQUcsQ0FBQ0ksSUFBSSxDQUFDRCxJQUFJLENBQUNJLENBQUMsQ0FBQyxDQUFDLEdBQUdQLEdBQUcsQ0FBQ04sUUFBUSxDQUFDTSxHQUFHLENBQUNJLElBQUksQ0FBQ0QsSUFBSSxDQUFDSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUNFLElBQUksQ0FBQyxDQUFDO01BQ2xFO0lBQ0o7SUFDQSxJQUFHVCxHQUFHLENBQUNVLE1BQU0sRUFBQztNQUNWUCxJQUFJLEdBQUdFLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDTixHQUFHLENBQUNVLE1BQU0sQ0FBQztNQUM5QixLQUFJLElBQUlILENBQUMsR0FBQyxDQUFDLEVBQUNBLENBQUMsR0FBQ0osSUFBSSxDQUFDTCxNQUFNLEVBQUNTLENBQUMsRUFBRSxFQUFDO1FBQzFCLElBQUdYLE1BQU0sQ0FBQ1ksT0FBTyxDQUFDTCxJQUFJLENBQUNJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksT0FBT1AsR0FBRyxDQUFDVSxNQUFNLENBQUNQLElBQUksQ0FBQ0ksQ0FBQyxDQUFDLENBQUMsSUFBSSxRQUFRLEVBQ3RFUCxHQUFHLENBQUNVLE1BQU0sQ0FBQ1AsSUFBSSxDQUFDSSxDQUFDLENBQUMsQ0FBQyxHQUFHUCxHQUFHLENBQUNOLFFBQVEsQ0FBQ00sR0FBRyxDQUFDVSxNQUFNLENBQUNQLElBQUksQ0FBQ0ksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDRSxJQUFJLENBQUMsQ0FBQztNQUN0RTtJQUNKO0lBQ0EsSUFBR1QsR0FBRyxDQUFDVyxLQUFLLEVBQUM7TUFDVFIsSUFBSSxHQUFHRSxNQUFNLENBQUNDLElBQUksQ0FBQ04sR0FBRyxDQUFDVyxLQUFLLENBQUM7TUFDN0IsS0FBSSxJQUFJSixDQUFDLEdBQUMsQ0FBQyxFQUFDQSxDQUFDLEdBQUNKLElBQUksQ0FBQ0wsTUFBTSxFQUFDUyxDQUFDLEVBQUUsRUFBQztRQUMxQixJQUFHWCxNQUFNLENBQUNZLE9BQU8sQ0FBQ0wsSUFBSSxDQUFDSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLE9BQU9QLEdBQUcsQ0FBQ1csS0FBSyxDQUFDUixJQUFJLENBQUNJLENBQUMsQ0FBQyxDQUFDLElBQUksUUFBUSxFQUNyRVAsR0FBRyxDQUFDVyxLQUFLLENBQUNSLElBQUksQ0FBQ0ksQ0FBQyxDQUFDLENBQUMsR0FBR1AsR0FBRyxDQUFDTixRQUFRLENBQUNNLEdBQUcsQ0FBQ1csS0FBSyxDQUFDUixJQUFJLENBQUNJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQ0UsSUFBSSxDQUFDLENBQUM7TUFDcEU7SUFDSjtJQUNBUCxJQUFJLENBQUMsQ0FBQztFQUNWLENBQUM7QUFDTCxDQUFDIiwiaWdub3JlTGlzdCI6W119